/*!
 * Copyright (c) 2021 Prolincur Technologies LLP.
 * Copyright (c) 2015 GDS Storefront Estimating
 * All Rights Reserved.
 * 
 * Please check the provided LICENSE file for licensing details.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,
 * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR
 * PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT
 * OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 * 
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("three")):"function"==typeof define&&define.amd?define(["THREE"],t):"object"==typeof exports?exports.ThreeDxfLoader=t(require("three")):e.ThreeDxfLoader=t(e.THREE)}("undefined"==typeof self?this:self,(function(e){var t=Math.sqrt,n=Math.pow,a=Math.PI,r=Math.abs;return function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:a})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(t.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(a,r,function(t){return e[t]}.bind(null,r));return a},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=5)}([function(t){t.exports=e},function(e,t,n){var a,r;!function(o,i){"use strict";a=function(){function e(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function t(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function n(n){return"debug"===n&&(n="log"),typeof console!==c&&("trace"===n&&u?t:void 0===console[n]?void 0===console.log?s:e(console,"log"):e(console,n))}function a(e,t){for(var n,a=0;a<l.length;a++)this[n=l[a]]=a<e?s:this.methodFactory(n,e,t);this.log=this.debug}function r(e,t,n){return function(){typeof console!==c&&(a.call(this,t,n),this[e].apply(this,arguments))}}function o(e){return n(e)||r.apply(this,arguments)}function i(e,t,n){function r(){var e;if(typeof window!==c){try{e=window.localStorage[u]}catch(e){}if(typeof e===c)try{var t=window.document.cookie,n=t.indexOf(encodeURIComponent(u)+"=");-1!==n&&(e=/^([^;]+)/.exec(t.slice(n))[1])}catch(e){}return void 0===s.levels[e]&&(e=void 0),e}}var i,s=this,u="loglevel";e&&(u+=":"+e),s.name=e,s.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},s.methodFactory=n||o,s.getLevel=function(){return i},s.setLevel=function(t,n){if("string"==typeof t&&void 0!==s.levels[t.toUpperCase()]&&(t=s.levels[t.toUpperCase()]),!("number"==typeof t&&0<=t&&t<=s.levels.SILENT))throw"log.setLevel() called with invalid level: "+t;if(i=t,!1!==n&&function(e){var t=(l[e]||"silent").toUpperCase();if(typeof window!==c){try{return void(window.localStorage[u]=t)}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"="+t+";"}catch(e){}}}(t),a.call(s,t,e),typeof console===c&&t<s.levels.SILENT)return"No console available for logging"},s.setDefaultLevel=function(e){r()||s.setLevel(e,!1)},s.enableAll=function(e){s.setLevel(s.levels.TRACE,e)},s.disableAll=function(e){s.setLevel(s.levels.SILENT,e)};var p=r();null==p&&(p=null==t?"WARN":t),s.setLevel(p,!1)}var s=function(){},c="undefined",u=typeof window!==c&&typeof window.navigator!==c&&/Trident\/|MSIE /.test(window.navigator.userAgent),l=["trace","debug","info","warn","error"],p=new i,d={};p.getLogger=function(e){if("string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=d[e];return t||(t=d[e]=new i(e,p.getLevel(),p.methodFactory)),t};var f=typeof window==c?void 0:window.log;return p.noConflict=function(){return typeof window!=c&&window.log===p&&(window.log=f),p},p.getLoggers=function(){return d},p},void 0===(r="function"==typeof a?a.call(t,n,t,e):a)||(e.exports=r)}()},function(e,t,n){(function(n){var a;!function(t,n){e.exports=n(t)}("undefined"==typeof self?"undefined"==typeof window?void 0===n?this:n:window:self,(function(n){"use strict";var r,o=(n=n||{}).Base64,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=function(e){for(var t={},n=0,a=e.length;n<a;n++)t[e.charAt(n)]=n;return t}(i),c=String.fromCharCode,u=function(e){if(2>e.length)return 128>(t=e.charCodeAt(0))?e:2048>t?c(192|t>>>6)+c(128|63&t):c(224|15&t>>>12)+c(128|63&t>>>6)+c(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return c(240|7&t>>>18)+c(128|63&t>>>12)+c(128|63&t>>>6)+c(128|63&t)},l=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,p=function(e){return e.replace(l,u)},d=function(e){var t=[0,2,1][e.length%3],n=e.charCodeAt(0)<<16|(1<e.length?e.charCodeAt(1):0)<<8|(2<e.length?e.charCodeAt(2):0);return[i.charAt(n>>>18),i.charAt(63&n>>>12),2<=t?"=":i.charAt(63&n>>>6),1<=t?"=":i.charAt(63&n)].join("")},f=n.btoa&&"function"==typeof n.btoa?function(e){return n.btoa(e)}:function(e){if(e.match(/[^\x00-\xFF]/))throw new RangeError("The string contains invalid characters.");return e.replace(/[\s\S]{1,3}/g,d)},v=function(e){return f(p(e+""))},h=function(e){return e.replace(/[+\/]/g,(function(e){return"+"==e?"-":"_"})).replace(/=/g,"")},b=function(e,t){return t?h(v(e)):v(e)};n.Uint8Array&&(r=function(e,t){for(var n="",a=0,r=e.length;a<r;a+=3){var o=e[a],s=e[a+1],c=e[a+2],u=o<<16|s<<8|c;n+=i.charAt(u>>>18)+i.charAt(63&u>>>12)+(void 0===s?"=":i.charAt(63&u>>>6))+(void 0===c?"=":i.charAt(63&u))}return t?h(n):n});var y,x=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,g=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return c(55296+(t>>>10))+c(56320+(1023&t));case 3:return c((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return c((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},m=function(e){return e.replace(x,g)},k=function(e){var t=e.length,n=(0<t?s[e.charAt(0)]<<18:0)|(1<t?s[e.charAt(1)]<<12:0)|(2<t?s[e.charAt(2)]<<6:0)|(3<t?s[e.charAt(3)]:0),a=[c(n>>>16),c(255&n>>>8),c(255&n)];return a.length-=[0,0,2,1][t%4],a.join("")},E=n.atob&&"function"==typeof n.atob?function(e){return n.atob(e)}:function(e){return e.replace(/\S{1,4}/g,k)},w=function(e){return E((e+"").replace(/[^A-Za-z0-9\+\/]/g,""))},L=function(e){return function(e){return m(E(e))}((e+"").replace(/[-_]/g,(function(e){return"-"==e?"+":"/"})).replace(/[^A-Za-z0-9\+\/]/g,""))};n.Uint8Array&&(y=function(e){return Uint8Array.from(w(e),(function(e){return e.charCodeAt(0)}))});if(n.Base64={VERSION:"2.6.2",atob:w,btoa:f,fromBase64:L,toBase64:b,utob:p,encode:b,encodeURI:function(e){return b(e,!0)},btou:m,decode:L,noConflict:function(){var e=n.Base64;return n.Base64=o,e},fromUint8Array:r,toUint8Array:y},"function"==typeof Object.defineProperty){var O=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};n.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",O((function(){return L(this)}))),Object.defineProperty(String.prototype,"toBase64",O((function(e){return b(this,e)}))),Object.defineProperty(String.prototype,"toBase64URI",O((function(){return b(this,!0)})))}}return n.Meteor&&(Base64=n.Base64),e.exports?e.exports.Base64=n.Base64:void 0!==(a=function(){return n.Base64}.apply(t,[]))&&(e.exports=a),{Base64:n.Base64}}))}).call(this,n(4))},function(e,o,i){"use strict";function s(e){this._pointer=0,this._data=e,this._eof=!1}function c(e,t){return 9>=e?t:10<=e&&59>=e?parseFloat(t):60<=e&&99>=e?parseInt(t):100<=e&&109>=e?t:110<=e&&149>=e?parseFloat(t):160<=e&&179>=e?parseInt(t):210<=e&&239>=e?parseFloat(t):270<=e&&289>=e?parseInt(t):290<=e&&299>=e?function(e){if("0"===e)return!1;if("1"===e)return!0;throw TypeError("String '"+e+"' cannot be cast to Boolean type")}(t):300<=e&&369>=e?t:370<=e&&389>=e?parseInt(t):390<=e&&399>=e?t:400<=e&&409>=e?parseInt(t):410<=e&&419>=e?t:420<=e&&429>=e?parseInt(t):430<=e&&439>=e?t:440<=e&&459>=e?parseInt(t):460<=e&&469>=e?parseFloat(t):470<=e&&481>=e||999===e||1e3<=e&&1009>=e?t:1010<=e&&1059>=e?parseFloat(t):1060<=e&&1071>=e?parseInt(t):(console.log("WARNING: Group code does not have a defined type: %j",{code:e,value:t}),t)}function u(e){var t={};e.rewind();var n=e.next(),a=n.code;if(t.x=n.value,a+=10,(n=e.next()).code!=a)throw new Error("Expected code for point value to be "+a+" but got "+n.code+".");return t.y=n.value,a+=10,(n=e.next()).code!=a?(e.rewind(),t):(t.z=n.value,t)}function l(e,t){switch(t.code){case 0:e.type=t.value;break;case 5:e.handle=t.value;break;case 6:e.lineType=t.value;break;case 8:e.layer=t.value;break;case 48:e.lineTypeScale=t.value;break;case 60:e.visible=0===t.value;break;case 62:e.colorIndex=t.value,e.color=function(e){return V[e]}(r(t.value));break;case 67:e.inPaperSpace=0!==t.value;break;case 100:break;case 330:e.ownerHandle=t.value;break;case 347:e.materialObjectHandle=t.value;break;case 370:e.lineweight=t.value;break;case 420:e.color=t.value;break;case 1e3:e.extendedData=e.extendedData||{},e.extendedData.customStrings=e.extendedData.customStrings||[],e.extendedData.customStrings.push(t.value);break;case 1001:e.extendedData=e.extendedData||{},e.extendedData.applicationName=t.value;break;default:return!1}return!0}function p(){}function d(e,t){var n,a=[],r=!1,o=!1;for(n=0;n<=4;n++){for(var i={};"EOF"!==t&&0!==t.code&&!o;){switch(t.code){case 10:case 11:case 12:case 13:if(r){o=!0;continue}i.x=t.value,r=!0;break;case 20:case 21:case 22:case 23:i.y=t.value;break;case 30:case 31:case 32:case 33:i.z=t.value;break;default:return a}t=e.next()}a.push(i),r=!1,o=!1}return e.rewind(),a}function f(){}function v(){}function h(){}function b(){}function y(){}function x(){}function g(){}function m(){}function k(e,t){if(!e||0>=e)throw Error("n must be greater than 0 verticies");var n,a=[],r=!1,o=!1,i=t.lastReadGroup;for(n=0;n<e;n++){for(var s={};"EOF"!==i&&0!==i.code&&!o;){switch(i.code){case 10:if(r){o=!0;continue}s.x=i.value,r=!0;break;case 20:s.y=i.value;break;case 30:s.z=i.value;break;case 40:s.startWidth=i.value;break;case 41:s.endWidth=i.value;break;case 42:0!=i.value&&(s.bulge=i.value);break;default:return r&&a.push(s),t.rewind(),a}i=t.next()}a.push(s),r=!1,o=!1}return t.rewind(),a}function E(){}function w(){}function L(){}function O(){}function T(e,t){var n={type:t.value};for(t=e.next();"EOF"!=t&&0!=t.code;)l(n,t),t=e.next();return n}function P(){}function S(){}function A(){}function C(){this._entityHandlers={},function(e){e.registerEntityHandler(p),e.registerEntityHandler(f),e.registerEntityHandler(v),e.registerEntityHandler(h),e.registerEntityHandler(b),e.registerEntityHandler(y),e.registerEntityHandler(x),e.registerEntityHandler(g),e.registerEntityHandler(m),e.registerEntityHandler(E),e.registerEntityHandler(w),e.registerEntityHandler(O),e.registerEntityHandler(P),e.registerEntityHandler(S),e.registerEntityHandler(A)}(this)}function F(e){z.a.debug("unhandled group "+N(e))}function N(e){return e.code+":"+e.value}function D(e){return V[e]}var R=Math.max,j=Math.sin;i.r(o),i.d(o,"DXFLoader",(function(){return U}));var I=i(0),B=i(2);s.prototype.next=function(){var e;if(!this.hasNext())throw this._eof?new Error("Cannot call 'next' after EOF group has been read"):new Error("Unexpected end of input: EOF group not read before end of file. Ended on code "+this._data[this._pointer]);return e={code:parseInt(this._data[this._pointer])},this._pointer++,e.value=c(e.code,this._data[this._pointer].trim()),this._pointer++,0===e.code&&"EOF"===e.value&&(this._eof=!0),this.lastReadGroup=e,e},s.prototype.peek=function(){if(!this.hasNext())throw this._eof?new Error("Cannot call 'next' after EOF group has been read"):new Error("Unexpected end of input: EOF group not read before end of file. Ended on code "+this._data[this._pointer]);var e={code:parseInt(this._data[this._pointer])};return e.value=c(e.code,this._data[this._pointer+1].trim()),e},s.prototype.rewind=function(e){e=e||1,this._pointer-=2*e},s.prototype.hasNext=function(){return!(this._eof||this._pointer>this._data.length-2)},s.prototype.isEOF=function(){return this._eof};var V=[0,16711680,16776960,65280,65535,255,16711935,16777215,8421504,12632256,16711680,16744319,13369344,13395558,10027008,10046540,8323072,8339263,4980736,4990502,16727808,16752511,13382400,13401958,10036736,10051404,8331008,8343359,4985600,4992806,16744192,16760703,13395456,13408614,10046464,10056268,8339200,8347455,4990464,4995366,16760576,16768895,13408512,13415014,10056192,10061132,8347392,8351551,4995328,4997670,16776960,16777087,13421568,13421670,10000384,10000460,8355584,8355647,5000192,5000230,12582656,14679935,10079232,11717734,7510016,8755276,6258432,7307071,3755008,4344870,8388352,12582783,6736896,10079334,5019648,7510092,4161280,6258495,2509824,3755046,4194048,10485631,3394560,8375398,2529280,6264908,2064128,5209919,1264640,3099686,65280,8388479,52224,6736998,38912,5019724,32512,4161343,19456,2509862,65343,8388511,52275,6737023,38950,5019743,32543,4161359,19475,2509871,65407,8388543,52326,6737049,38988,5019762,32575,4161375,19494,2509881,65471,8388575,52377,6737074,39026,5019781,32607,4161391,19513,2509890,65535,8388607,52428,6737100,39064,5019800,32639,4161407,19532,2509900,49151,8380415,39372,6730444,29336,5014936,24447,4157311,14668,2507340,32767,8372223,26316,6724044,19608,5010072,16255,4153215,9804,2505036,16383,8364031,13260,6717388,9880,5005208,8063,4149119,4940,2502476,255,8355839,204,6710988,152,5000344,127,4145023,76,2500172,4129023,10452991,3342540,8349388,2490520,6245528,2031743,5193599,1245260,3089996,8323327,12550143,6684876,10053324,4980888,7490712,4128895,6242175,2490444,3745356,12517631,14647295,10027212,11691724,7471256,8735896,6226047,7290751,3735628,4335180,16711935,16744447,13369548,13395660,9961624,9981080,8323199,8339327,4980812,4990540,16711871,16744415,13369497,13395634,9961586,9981061,8323167,8339311,4980793,4990530,16711807,16744383,13369446,13395609,9961548,9981042,8323135,8339295,4980774,4990521,16711743,16744351,13369395,13395583,9961510,9981023,8323103,8339279,4980755,4990511,3355443,5987163,8684676,11382189,14079702,16777215];p.ForEntityName="3DFACE",p.prototype.parseEntity=function(e,t){var n={type:t.value,vertices:[]};for(t=e.next();"EOF"!==t&&0!==t.code;){switch(t.code){case 70:n.shape=1==(1&t.value),n.hasContinuousLinetypePattern=128==(128&t.value);break;case 10:n.vertices=d(e,t),t=e.lastReadGroup;break;default:l(n,t)}t=e.next()}return n},f.ForEntityName="ARC",f.prototype.parseEntity=function(e,t){var n;for(n={type:t.value},t=e.next();"EOF"!==t&&0!==t.code;){switch(t.code){case 10:n.center=u(e);break;case 40:n.radius=t.value;break;case 50:n.startAngle=a/180*t.value;break;case 51:n.endAngle=a/180*t.value,n.angleLength=n.endAngle-n.startAngle;break;default:l(n,t)}t=e.next()}return n},v.ForEntityName="ATTDEF",v.prototype.parseEntity=function(e,t){var n={type:t.value,scale:1,textStyle:"STANDARD"};for(t=e.next();"EOF"!==t&&0!==t.code;){switch(t.code){case 1:n.text=t.value;break;case 2:n.tag=t.value;break;case 3:n.prompt=t.value;break;case 7:n.textStyle=t.value;break;case 10:n.startPoint=u(e);break;case 11:n.endPoint=u(e);break;case 39:n.thickness=t.value;break;case 40:n.textHeight=t.value;break;case 41:n.scale=t.value;break;case 50:n.rotation=t.value;break;case 51:n.obliqueAngle=t.value;break;case 70:n.invisible=!!(1&t.value),n.constant=!!(2&t.value),n.verificationRequired=!!(4&t.value),n.preset=!!(8&t.value);break;case 71:n.backwards=!!(2&t.value),n.mirrored=!!(4&t.value);break;case 72:n.horizontalJustification=t.value;break;case 73:n.fieldLength=t.value;break;case 74:n.verticalJustification=t.value;break;case 100:break;case 210:n.extrusionDirectionX=t.value;break;case 220:n.extrusionDirectionY=t.value;break;case 230:n.extrusionDirectionZ=t.value;break;default:l(n,t)}t=e.next()}return n},h.ForEntityName="CIRCLE",h.prototype.parseEntity=function(e,t){var n,r;for(n={type:t.value},t=e.next();"EOF"!==t&&0!==t.code;){switch(t.code){case 10:n.center=u(e);break;case 40:n.radius=t.value;break;case 50:n.startAngle=a/180*t.value;break;case 51:r=a/180*t.value,n.angleLength=r<n.startAngle?r+2*a-n.startAngle:r-n.startAngle,n.endAngle=r;break;default:l(n,t)}t=e.next()}return n},b.ForEntityName="DIMENSION",b.prototype.parseEntity=function(e,t){var n;for(n={type:t.value},t=e.next();"EOF"!==t&&0!==t.code;){switch(t.code){case 2:n.block=t.value;break;case 10:n.anchorPoint=u(e);break;case 11:n.middleOfText=u(e);break;case 12:n.insertionPoint=u(e);break;case 13:n.linearOrAngularPoint1=u(e);break;case 14:n.linearOrAngularPoint2=u(e);break;case 15:n.diameterOrRadiusPoint=u(e);break;case 16:n.arcPoint=u(e);break;case 70:n.dimensionType=t.value;break;case 71:n.attachmentPoint=t.value;break;case 42:n.actualMeasurement=t.value;break;case 1:n.text=t.value;break;case 50:n.angle=t.value;break;default:l(n,t)}t=e.next()}return n},y.ForEntityName="ELLIPSE",y.prototype.parseEntity=function(e,t){var n;for(n={type:t.value},t=e.next();"EOF"!==t&&0!==t.code;){switch(t.code){case 10:n.center=u(e);break;case 11:n.majorAxisEndPoint=u(e);break;case 40:n.axisRatio=t.value;break;case 41:n.startAngle=t.value;break;case 42:n.endAngle=t.value;break;case 2:n.name=t.value;break;default:l(n,t)}t=e.next()}return n},x.ForEntityName="INSERT",x.prototype.parseEntity=function(e,t){var n;for(n={type:t.value},t=e.next();"EOF"!==t&&0!==t.code;){switch(t.code){case 2:n.name=t.value;break;case 41:n.xScale=t.value;break;case 42:n.yScale=t.value;break;case 43:n.zScale=t.value;break;case 10:n.position=u(e);break;case 50:n.rotation=t.value;break;case 70:n.columnCount=t.value;break;case 71:n.rowCount=t.value;break;case 44:n.columnSpacing=t.value;break;case 45:n.rowSpacing=t.value;break;case 210:n.extrusionDirection=u(e);break;default:l(n,t)}t=e.next()}return n},g.ForEntityName="LINE",g.prototype.parseEntity=function(e,t){var n={type:t.value,vertices:[]};for(t=e.next();"EOF"!==t&&0!==t.code;){switch(t.code){case 10:n.vertices.unshift(u(e));break;case 11:n.vertices.push(u(e));break;case 210:n.extrusionDirection=u(e);break;case 100:break;default:l(n,t)}t=e.next()}return n},m.ForEntityName="LWPOLYLINE",m.prototype.parseEntity=function(e,t){var n={type:t.value,vertices:[]},a=0;for(t=e.next();"EOF"!==t&&0!==t.code;){switch(t.code){case 38:n.elevation=t.value;break;case 39:n.depth=t.value;break;case 70:n.shape=1==(1&t.value),n.hasContinuousLinetypePattern=128==(128&t.value);break;case 90:a=t.value;break;case 10:n.vertices=k(a,e);break;case 43:0!==t.value&&(n.width=t.value);break;case 210:n.extrusionDirectionX=t.value;break;case 220:n.extrusionDirectionY=t.value;break;case 230:n.extrusionDirectionZ=t.value;break;default:l(n,t)}t=e.next()}return n},E.ForEntityName="MTEXT",E.prototype.parseEntity=function(e,t){var n={type:t.value};for(t=e.next();"EOF"!==t&&0!==t.code;){switch(t.code){case 3:case 1:n.text?n.text+=t.value:n.text=t.value;break;case 10:n.position=u(e);break;case 40:n.height=t.value;break;case 41:n.width=t.value;break;case 50:n.rotation=t.value;break;case 71:n.attachmentPoint=t.value;break;case 72:n.drawingDirection=t.value;break;default:l(n,t)}t=e.next()}return n},w.ForEntityName="POINT",w.prototype.parseEntity=function(e,t){var n;for(n={type:t.value},t=e.next();"EOF"!==t&&0!==t.code;){switch(t.code){case 10:n.position=u(e);break;case 39:n.thickness=t.value;break;case 210:n.extrusionDirection=u(e);break;case 100:break;default:l(n,t)}t=e.next()}return n},L.ForEntityName="VERTEX",L.prototype.parseEntity=function(e,t){var n={type:t.value};for(t=e.next();"EOF"!==t&&0!==t.code;){switch(t.code){case 10:n.x=t.value;break;case 20:n.y=t.value;break;case 30:n.z=t.value;break;case 40:case 41:break;case 42:0!=t.value&&(n.bulge=t.value);break;case 70:n.curveFittingVertex=0!=(1&t.value),n.curveFitTangent=0!=(2&t.value),n.splineVertex=0!=(8&t.value),n.splineControlPoint=0!=(16&t.value),n.threeDPolylineVertex=0!=(32&t.value),n.threeDPolylineMesh=0!=(64&t.value),n.polyfaceMeshVertex=0!=(128&t.value);break;case 50:break;case 71:n.faceA=t.value;break;case 72:n.faceB=t.value;break;case 73:n.faceC=t.value;break;case 74:n.faceD=t.value;break;default:l(n,t)}t=e.next()}return n},O.ForEntityName="POLYLINE",O.prototype.parseEntity=function(e,t){var n={type:t.value,vertices:[]};for(t=e.next();"EOF"!==t&&0!==t.code;){switch(t.code){case 10:case 20:case 30:break;case 39:n.thickness=t.value;break;case 40:case 41:break;case 70:n.shape=0!=(1&t.value),n.includesCurveFitVertices=0!=(2&t.value),n.includesSplineFitVertices=0!=(4&t.value),n.is3dPolyline=0!=(8&t.value),n.is3dPolygonMesh=0!=(16&t.value),n.is3dPolygonMeshClosed=0!=(32&t.value),n.isPolyfaceMesh=0!=(64&t.value),n.hasContinuousLinetypePattern=0!=(128&t.value);break;case 71:case 72:case 73:case 74:case 75:break;case 210:n.extrusionDirection=u(e);break;default:l(n,t)}t=e.next()}return n.vertices=function(e,t){for(var n=new L,a=[];!e.isEOF();)if(0===t.code)if("VERTEX"===t.value)a.push(n.parseEntity(e,t)),t=e.lastReadGroup;else if("SEQEND"===t.value){T(e,t);break}return a}(e,t),n},P.ForEntityName="SOLID",P.prototype.parseEntity=function(e,t){var n;for((n={type:t.value}).points=[],t=e.next();"EOF"!==t&&0!==t.code;){switch(t.code){case 10:n.points[0]=u(e);break;case 11:n.points[1]=u(e);break;case 12:n.points[2]=u(e);break;case 13:n.points[3]=u(e);break;case 210:n.extrusionDirection=u(e);break;default:l(n,t)}t=e.next()}return n},S.ForEntityName="SPLINE",S.prototype.parseEntity=function(e,t){var n;for(n={type:t.value},t=e.next();"EOF"!==t&&0!==t.code;){switch(t.code){case 10:n.controlPoints||(n.controlPoints=[]),n.controlPoints.push(u(e));break;case 11:n.fitPoints||(n.fitPoints=[]),n.fitPoints.push(u(e));break;case 12:n.startTangent=u(e);break;case 13:n.endTangent=u(e);break;case 40:n.knotValues||(n.knotValues=[]),n.knotValues.push(t.value);break;case 70:0!=(1&t.value)&&(n.closed=!0),0!=(2&t.value)&&(n.periodic=!0),0!=(4&t.value)&&(n.rational=!0),0!=(8&t.value)&&(n.planar=!0),0!=(16&t.value)&&(n.planar=!0,n.linear=!0);break;case 71:n.degreeOfSplineCurve=t.value;break;case 72:n.numberOfKnots=t.value;break;case 73:n.numberOfControlPoints=t.value;break;case 74:n.numberOfFitPoints=t.value;break;case 210:n.normalVector=u(e);break;default:l(n,t)}t=e.next()}return n},A.ForEntityName="TEXT",A.prototype.parseEntity=function(e,t){var n;for(n={type:t.value},t=e.next();"EOF"!==t&&0!==t.code;){switch(t.code){case 10:n.startPoint=u(e);break;case 11:n.endPoint=u(e);break;case 40:n.textHeight=t.value;break;case 41:n.xScale=t.value;break;case 50:n.rotation=t.value;break;case 1:n.text=t.value;break;case 72:n.halign=t.value;break;case 73:n.valign=t.value;break;default:l(n,t)}t=e.next()}return n};var _=i(1),z=i.n(_);z.a.setLevel("error"),C.prototype.parse=function(){throw new Error("read() not implemented. Use readSync()")},C.prototype.registerEntityHandler=function(e){var t=new e;this._entityHandlers[e.ForEntityName]=t},C.prototype.parseSync=function(e){return"string"==typeof e?this._parse(e):(console.error("Cannot read dxf source of type `"+typeof e),null)},C.prototype.parseStream=function(e,t){var n="",a=this;e.on("data",(function(e){n+=e})),e.on("end",(function(){try{var e=a._parse(n)}catch(e){return t(e)}t(null,e)})),e.on("error",(function(e){t(e)}))},C.prototype._parse=function(e){var t,n,a={},o=0,i=e.split(/\r\n|\r|\n/g);if(!(t=new s(i)).hasNext())throw Error("Empty file");var c=this,u=function(e,t){return n.code===e&&n.value===t},l=function(){var e=null,a=null,r={};for(n=t.next();;){if(u(0,"ENDSEC")){e&&(r[e]=a);break}9===n.code?(e&&(r[e]=a),e=n.value):10===n.code?a={x:n.value}:20===n.code?a.y=n.value:30===n.code?a.z=n.value:a=n.value,n=t.next()}return n=t.next(),r},p=function(){var e,a={};for(n=t.next();"EOF"!==n.value&&!u(0,"ENDSEC");)u(0,"BLOCK")?(z.a.debug("block {"),e=d(),z.a.debug("}"),g(e),e.name?a[e.name]=e:z.a.error('block with handle "'+e.handle+'" is missing a name.')):(F(n),n=t.next());return a},d=function(){var e={};for(n=t.next();"EOF"!==n.value;){switch(n.code){case 1:e.xrefPath=n.value,n=t.next();break;case 2:e.name=n.value,n=t.next();break;case 3:e.name2=n.value,n=t.next();break;case 5:e.handle=n.value,n=t.next();break;case 8:e.layer=n.value,n=t.next();break;case 10:e.position=x(),n=t.next();break;case 67:e.paperSpace=!(!n.value||1!=n.value),n=t.next();break;case 70:0!=n.value&&(e.type=n.value),n=t.next();break;case 100:n=t.next();break;case 330:e.ownerHandle=n.value,n=t.next();break;case 0:if("ENDBLK"==n.value)break;e.entities=y(!0);break;default:F(n),n=t.next()}if(u(0,"ENDBLK")){n=t.next();break}}return e},f=function(){var e={};for(n=t.next();"EOF"!==n.value&&!u(0,"ENDSEC");)if(u(0,"TABLE")){n=t.next(),b[n.value]?(z.a.debug(n.value+" Table {"),e[b[n.value].tableName]=h(),z.a.debug("}")):z.a.debug("Unhandled Table "+n.value)}else n=t.next();return n=t.next(),e};const v="ENDTAB";var h=function(){var e,a=b[n.value],r={},o=0;for(n=t.next();!u(0,v);)switch(n.code){case 5:r.handle=n.value,n=t.next();break;case 330:r.ownerHandle=n.value,n=t.next();break;case 100:"AcDbSymbolTable"===n.value||F(n),n=t.next();break;case 70:o=n.value,n=t.next();break;case 0:n.value===a.dxfSymbolName?r[a.tableRecordsProperty]=a.parseTableRecords():(F(n),n=t.next());break;default:F(n),n=t.next()}var i=r[a.tableRecordsProperty];return i&&(i.constructor===Array?e=i.length:"object"==typeof i&&(e=Object.keys(i).length),o!==e&&z.a.warn("Parsed "+e+" "+a.dxfSymbolName+"'s but expected "+o)),n=t.next(),r},b={VPORT:{tableRecordsProperty:"viewPorts",tableName:"viewPort",dxfSymbolName:"VPORT",parseTableRecords:function(){var e=[],a={};for(z.a.debug("ViewPort {"),n=t.next();!u(0,v);)switch(n.code){case 2:a.name=n.value,n=t.next();break;case 10:a.lowerLeftCorner=x(),n=t.next();break;case 11:a.upperRightCorner=x(),n=t.next();break;case 12:a.center=x(),n=t.next();break;case 13:a.snapBasePoint=x(),n=t.next();break;case 14:a.snapSpacing=x(),n=t.next();break;case 15:a.gridSpacing=x(),n=t.next();break;case 16:a.viewDirectionFromTarget=x(),n=t.next();break;case 17:a.viewTarget=x(),n=t.next();break;case 42:a.lensLength=n.value,n=t.next();break;case 43:a.frontClippingPlane=n.value,n=t.next();break;case 44:a.backClippingPlane=n.value,n=t.next();break;case 45:a.viewHeight=n.value,n=t.next();break;case 50:a.snapRotationAngle=n.value,n=t.next();break;case 51:a.viewTwistAngle=n.value,n=t.next();break;case 79:a.orthographicType=n.value,n=t.next();break;case 110:a.ucsOrigin=x(),n=t.next();break;case 111:a.ucsXAxis=x(),n=t.next();break;case 112:a.ucsYAxis=x(),n=t.next();break;case 110:a.ucsOrigin=x(),n=t.next();break;case 281:a.renderMode=n.value,n=t.next();break;case 281:a.defaultLightingType=n.value,n=t.next();break;case 292:a.defaultLightingOn=n.value,n=t.next();break;case 330:a.ownerHandle=n.value,n=t.next();break;case 63:case 421:case 431:a.ambientColor=n.value,n=t.next();break;case 0:"VPORT"===n.value&&(z.a.debug("}"),e.push(a),z.a.debug("ViewPort {"),a={},n=t.next());break;default:F(n),n=t.next()}return z.a.debug("}"),e.push(a),e}},LTYPE:{tableRecordsProperty:"lineTypes",tableName:"lineType",dxfSymbolName:"LTYPE",parseTableRecords:function(){var e,a,r={},o={};for(z.a.debug("LType {"),n=t.next();!u(0,"ENDTAB");)switch(n.code){case 2:o.name=n.value,e=n.value,n=t.next();break;case 3:o.description=n.value,n=t.next();break;case 73:0<(a=n.value)&&(o.pattern=[]),n=t.next();break;case 40:o.patternLength=n.value,n=t.next();break;case 49:o.pattern.push(n.value),n=t.next();break;case 0:z.a.debug("}"),0<a&&a!==o.pattern.length&&z.a.warn("lengths do not match on LTYPE pattern"),r[e]=o,o={},z.a.debug("LType {"),n=t.next();break;default:n=t.next()}return z.a.debug("}"),r[e]=o,r}},LAYER:{tableRecordsProperty:"layers",tableName:"layer",dxfSymbolName:"LAYER",parseTableRecords:function(){var e,a={},o={};for(z.a.debug("Layer {"),n=t.next();!u(0,"ENDTAB");)switch(n.code){case 2:o.name=n.value,e=n.value,n=t.next();break;case 62:o.visible=0<=n.value,o.colorIndex=r(n.value),o.color=D(o.colorIndex),n=t.next();break;case 70:o.frozen=0!=(1&n.value)||0!=(2&n.value),n=t.next();break;case 0:"LAYER"===n.value&&(z.a.debug("}"),a[e]=o,z.a.debug("Layer {"),o={},e=void 0,n=t.next());break;default:F(n),n=t.next()}return z.a.debug("}"),a[e]=o,a}}},y=function(e){var a=[],r=e?"ENDBLK":"ENDSEC";for(e||(n=t.next());;)if(0===n.code){if(n.value===r)break;var o,i=c._entityHandlers[n.value];if(null==i){z.a.warn("Unhandled entity "+n.value),n=t.next();continue}z.a.debug(n.value+" {"),o=i.parseEntity(t,n),n=t.lastReadGroup,z.a.debug("}"),g(o),a.push(o)}else n=t.next();return"ENDSEC"==r&&(n=t.next()),a},x=function(){var e={},a=n.code;if(e.x=n.value,a+=10,(n=t.next()).code!=a)throw new Error("Expected code for point value to be "+a+" but got "+n.code+".");return e.y=n.value,a+=10,(n=t.next()).code!=a?(t.rewind(),e):(e.z=n.value,e)},g=function(e){if(!e)throw new TypeError("entity cannot be undefined or null");e.handle||(e.handle=o++)};return function(){for(n=t.next();!t.isEOF();)if(0===n.code&&"SECTION"===n.value){if(2!==(n=t.next()).code){console.error("Unexpected code %s after 0:SECTION",N(n)),n=t.next();continue}"HEADER"===n.value?(z.a.debug("> HEADER"),a.header=l(),z.a.debug("<")):"BLOCKS"===n.value?(z.a.debug("> BLOCKS"),a.blocks=p(),z.a.debug("<")):"ENTITIES"===n.value?(z.a.debug("> ENTITIES"),a.entities=y(!1),z.a.debug("<")):"TABLES"===n.value?(z.a.debug("> TABLES"),a.tables=f(),z.a.debug("<")):"EOF"===n.value?z.a.debug("EOF"):z.a.warn("Skipping section '%s'",n.value)}else n=t.next()}(),a};const M=function(e,t){var n=Math.acos,a=new I.Vector2(e.x,e.y),r=new I.Vector2(t.x,t.y);return r.sub(a),r.normalize(),0>r.y?-n(r.x):n(r.x)},H=function(e,t,n){return{x:e.x+t*Math.cos(n),y:e.y+t*j(n)}};I.BulgeGeometry=function(e,t,n,o){var i,s,c,u,l,p,d,f,v;for(I.Geometry.call(this),this.startPoint=u=e?new I.Vector2(e.x,e.y):new I.Vector2(0,0),this.endPoint=l=t?new I.Vector2(t.x,t.y):new I.Vector2(1,0),this.bulge=n=n||1,p=4*Math.atan(n),d=u.distanceTo(l)/2/j(p/2),c=H(e,d,M(u,l)+(a/2-p/2)),this.segments=o=o||R(r(Math.ceil(p/(a/18))),6),f=M(c,u),v=p/o,this.vertices.push(new I.Vector3(u.x,u.y,0)),s=1;s<=o-1;s++)i=H(c,r(d),f+v*s),this.vertices.push(new I.Vector3(i.x,i.y,0))},I.BulgeGeometry.prototype=Object.create(I.Geometry.prototype);const U=function(e){I.Loader.call(this,e),this.font=null};U.prototype=Object.assign(Object.create(I.Loader.prototype),{constructor:U,setFont:function(e){return this.font=e,this},load:function(e,t,n,a){var r=this,o=new I.XHRLoader(r.manager);o.setPath(r.path);const i=function(e){if(e){const t=e.match(/data:([a-zA-Z0-9]+\/[a-zA-Z0-9-.+]+).*,.*/);if(t&&0<t.length){const n=t[1],a=e.replace("data:"+n+";","").split(",");if(a&&2===a.length&&"base64"===a[0]){const e=a[1];return B.Base64.decode(e)}}}return null}(e);i?r.loadString(i,t,a):o.load(e,e=>{r.loadString(e,t,a)},n,a)},loadString:function(e,t,n){try{t(this.parse(e))}catch(e){n?n(e):console.error(e),this.manager.itemError(url)}},parse:function(e){var t=(new C).parseSync(e);return this.loadEntities(t,this.font)},loadEntities:function(e,o){function i(e,t){var n;if("CIRCLE"===e.type||"ARC"===e.type)n=c(e,t);else if("LWPOLYLINE"===e.type||"LINE"===e.type||"POLYLINE"===e.type)n=function(e,t){var n,a,r,o,i,s,c,u,l=new I.Geometry,d=p(e,t);if(!e.vertices)return console.log("entity missing vertices.");for(u=0;u<e.vertices.length;u++)e.vertices[u].bulge?(c=e.vertices[u].bulge,o=e.vertices[u],i=u+1<e.vertices.length?e.vertices[u+1]:l.vertices[0],s=new I.BulgeGeometry(o,i,c),l.vertices.push.apply(l.vertices,s.vertices)):(r=e.vertices[u],l.vertices.push(new I.Vector3(r.x,r.y,0)));return e.shape&&l.vertices.push(l.vertices[0]),e.lineType&&(a=t.tables.lineType.lineTypes[e.lineType]),n=a&&a.pattern&&0!==a.pattern.length?new I.LineDashedMaterial({color:d,gapSize:4,dashSize:4}):new I.LineBasicMaterial({linewidth:1,color:d}),new I.Line(l,n)}(e,t);else if("TEXT"===e.type)n=u(e,t);else if("SOLID"===e.type)n=function(e,t){var n,a,r=new I.Geometry;(a=r.vertices).push(new I.Vector3(e.points[0].x,e.points[0].y,e.points[0].z)),a.push(new I.Vector3(e.points[1].x,e.points[1].y,e.points[1].z)),a.push(new I.Vector3(e.points[2].x,e.points[2].y,e.points[2].z)),a.push(new I.Vector3(e.points[3].x,e.points[3].y,e.points[3].z));var o=new I.Vector3,i=new I.Vector3;return o.subVectors(a[1],a[0]),i.subVectors(a[2],a[0]),o.cross(i),0>o.z?(r.faces.push(new I.Face3(2,1,0)),r.faces.push(new I.Face3(2,3,1))):(r.faces.push(new I.Face3(0,1,2)),r.faces.push(new I.Face3(1,3,2))),n=new I.MeshBasicMaterial({color:p(e,t)}),new I.Mesh(r,n)}(e,t);else if("POINT"===e.type)n=function(e,t){var n,a,r;(n=new I.Geometry).vertices.push(new I.Vector3(e.position.x,e.position.y,e.position.z));var o=p(e,t),i=new Float32Array(3);i[0]=o.r,i[1]=o.g,i[2]=o.b,n.colors=i,n.computeBoundingBox(),a=new I.PointsMaterial({size:.05,vertexColors:I.VertexColors}),r=new I.Points(n,a),h.push(r)}(e,t);else if("INSERT"===e.type)n=l(e,t);else if("SPLINE"===e.type)n=function(e,t){var n,a=p(e,t),r=e.controlPoints.map((function(e){return new I.Vector2(e.x,e.y)})),o=[];if(2===e.degreeOfSplineCurve||3===e.degreeOfSplineCurve){var i=0;for(i=0;i+2<r.length;i+=2)n=2===e.degreeOfSplineCurve?new I.QuadraticBezierCurve(r[i],r[i+1],r[i+2]):new I.QuadraticBezierCurve3(r[i],r[i+1],r[i+2]),o.push.apply(o,n.getPoints(50));i<r.length&&(n=new I.QuadraticBezierCurve3(r[i],r[i+1],r[i+1]),o.push.apply(o,n.getPoints(50)))}else n=new I.SplineCurve(r),o=n.getPoints(100);var s=(new I.BufferGeometry).setFromPoints(o),c=new I.LineBasicMaterial({linewidth:1,color:a});return new I.Line(s,c)}(e,t);else if("MTEXT"===e.type)n=function(e,t){var n=p(e,t);if(!o)return console.log("font parameter not set. Ignoring text entity.");var a=new I.TextGeometry(e.text,{font:o,size:.8*e.height,height:1}),r=new I.MeshBasicMaterial({color:n}),i=new I.Mesh(a,r),s=new I.Box3;s.setFromObject(i);var c=s.max.x-s.min.x;if(c>e.width)return void console.log("Can't render this multipline MTEXT entity, sorry.",e);switch(i.position.z=0,e.attachmentPoint){case 1:i.position.x=e.position.x,i.position.y=e.position.y-e.height;break;case 2:i.position.x=e.position.x-c/2,i.position.y=e.position.y-e.height;break;case 3:i.position.x=e.position.x-c,i.position.y=e.position.y-e.height;break;case 4:i.position.x=e.position.x,i.position.y=e.position.y-e.height/2;break;case 5:i.position.x=e.position.x-c/2,i.position.y=e.position.y-e.height/2;break;case 6:i.position.x=e.position.x-c,i.position.y=e.position.y-e.height/2;break;case 7:i.position.x=e.position.x,i.position.y=e.position.y;break;case 8:i.position.x=e.position.x-c/2,i.position.y=e.position.y;break;case 9:i.position.x=e.position.x-c,i.position.y=e.position.y;break;default:return}return i}(e,t);else if("ELLIPSE"===e.type)n=s(e,t);else if("DIMENSION"===e.type){var a=7&e.dimensionType;0==a?n=function(e,t){var n=t.blocks[e.block];if(!n||!n.entities)return null;for(var a,r=new I.Object3D,o=0;o<n.entities.length;o++)(a=i(n.entities[o],t))&&r.add(a);return r}(e,t):console.log("Unsupported Dimension type: "+a)}else"3DFACE"===e.type?console.log("Unsupported Entity Type: "+e.type,e):console.log("Unsupported Entity Type: "+e.type);return n}function s(e,a){var r=p(e,a),o=t(n(e.majorAxisEndPoint.x,2)+n(e.majorAxisEndPoint.y,2)),i=o*e.axisRatio,s=Math.atan2(e.majorAxisEndPoint.y,e.majorAxisEndPoint.x),c=new I.EllipseCurve(e.center.x,e.center.y,o,i,e.startAngle,e.endAngle,!1,s).getPoints(50),u=(new I.BufferGeometry).setFromPoints(c),l=new I.LineBasicMaterial({linewidth:1,color:r});return new I.Line(u,l)}function c(e,t){var n,r;"CIRCLE"===e.type?r=(n=e.startAngle||0)+2*a:(n=e.startAngle,r=e.endAngle);var o=new I.ArcCurve(0,0,e.radius,n,r).getPoints(32),i=(new I.BufferGeometry).setFromPoints(o),s=new I.LineBasicMaterial({color:p(e,t)}),c=new I.Line(i,s);return c.position.x=e.center.x,c.position.y=e.center.y,c.position.z=e.center.z,c}function u(e,t){var n,r,i;if(!o)return console.warn("Text is not supported without a Three.js font loaded with THREE.FontLoader! Load a font of your choice and pass this into the constructor. See the sample for this repository or Three.js examples at http://threejs.org/examples/?q=text#webgl_geometry_text for more details.");if(n=new I.TextGeometry(e.text,{font:o,height:0,size:e.textHeight||12}),e.rotation){var s=e.rotation*a/180;n.rotateZ(s)}return r=new I.MeshBasicMaterial({color:p(e,t)}),(i=new I.Mesh(n,r)).position.x=e.startPoint.x,i.position.y=e.startPoint.y,i.position.z=e.startPoint.z,i}function l(e,t){var n=t.blocks[e.name];if(!n.entities)return null;var r=new I.Object3D;e.xScale&&(r.scale.x=e.xScale),e.yScale&&(r.scale.y=e.yScale),e.rotation&&(r.rotation.z=e.rotation*a/180),e.position&&(r.position.x=e.position.x,r.position.y=e.position.y,r.position.z=e.position.z);for(var o,s=0;s<n.entities.length;s++)(o=i(n.entities[s],t))&&r.add(o);return r}function p(e,t){var n=0;return e.color?n=e.color:t.tables&&t.tables.layer&&t.tables.layer.layers[e.layer]&&(n=t.tables.layer.layers[e.layer].color),(null==n||16777215===n)&&(n=0),n}function d(e){var t,n={},a=0;for(t=0;t<e.length;t++)a+=r(e[t]);return n.uniforms=I.UniformsUtils.merge([I.UniformsLib.common,I.UniformsLib.fog,{pattern:{type:"fv1",value:e},patternLength:{type:"f",value:a}}]),n.vertexShader=["attribute float lineDistance;","varying float vLineDistance;",I.ShaderChunk.color_pars_vertex,"void main() {",I.ShaderChunk.color_vertex,"vLineDistance = lineDistance;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),n.fragmentShader=["uniform vec3 diffuse;","uniform float opacity;","uniform float pattern["+e.length+"];","uniform float patternLength;","varying float vLineDistance;",I.ShaderChunk.color_pars_fragment,I.ShaderChunk.fog_pars_fragment,"void main() {","float pos = mod(vLineDistance, patternLength);","for ( int i = 0; i < "+e.length+"; i++ ) {","pos = pos - abs(pattern[i]);","if( pos < 0.0 ) {","if( pattern[i] > 0.0 ) {","gl_FragColor = vec4(1.0, 0.0, 0.0, opacity );","break;","}","discard;","}","}",I.ShaderChunk.color_fragment,I.ShaderChunk.fog_fragment,"}"].join("\n"),n}!function(e){var t,n;if(e.tables&&e.tables.lineType){var a=e.tables.lineType.lineTypes;for(n in a)(t=a[n]).pattern&&(t.material=d(t.pattern))}}(e);var f,v,h=[];for(f=0;f<e.entities.length;f++)(v=i(e.entities[f],e))&&h.push(v),v=null;return{entities:h,dxf:e}}})},function(e){var t=function(){return this}();try{t=t||new Function("return this")()}catch(e){"object"==typeof window&&(t=window)}e.exports=t},function(e,o,i){"use strict";function s(e,r){function o(){return 2*a/60/60*p.autoRotateSpeed}function i(){return n(.95,p.zoomSpeed)}function s(e){if(!1!==p.enabled){e.preventDefault();var t=p.domElement===document?p.domElement.body:p.domElement;if(T===O.ROTATE){if(!0===p.noRotate)return;f.set(e.clientX,e.clientY),v.subVectors(f,d),p.rotateLeft(2*a*v.x/t.clientWidth*p.rotateSpeed),p.rotateUp(2*a*v.y/t.clientHeight*p.rotateSpeed),d.copy(f)}else if(T===O.DOLLY){if(!0===p.noZoom)return;k.set(e.clientX,e.clientY),E.subVectors(k,m),0<E.y?p.dollyIn():p.dollyOut(),m.copy(k)}else if(T===O.PAN){if(!0===p.noPan)return;b.set(e.clientX,e.clientY),y.subVectors(b,h),p.pan(y.x,y.y),h.copy(b)}p.update()}}function c(){!1===p.enabled||(p.domElement.removeEventListener("mousemove",s,!1),p.domElement.removeEventListener("mouseup",c,!1),p.dispatchEvent(A),T=O.NONE)}function l(e){if(!1!==p.enabled&&!0!==p.noZoom){e.preventDefault();var t=0;void 0===e.wheelDelta?void 0!==e.detail&&(t=-e.detail):t=e.wheelDelta,0<t?p.dollyOut():p.dollyIn(),p.update(),p.dispatchEvent(S),p.dispatchEvent(A)}}this.object=e,this.domElement=void 0===r?document:r,this.enabled=!0,this.target=new u.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=a,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};var p=this,d=new u.Vector2,f=new u.Vector2,v=new u.Vector2,h=new u.Vector2,b=new u.Vector2,y=new u.Vector2,x=new u.Vector3,g=new u.Vector3,m=new u.Vector2,k=new u.Vector2,E=new u.Vector2,w=1,L=new u.Vector3,O=(new u.Vector3,{NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5}),T=O.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone();var P={type:"change"},S={type:"start"},A={type:"end"};this.rotateLeft=function(e){void 0===e&&(e=o()),e},this.rotateUp=function(e){void 0===e&&(e=o()),e},this.panLeft=function(e){var t=this.object.matrix.elements;x.set(t[0],t[1],t[2]),x.multiplyScalar(-e),L.add(x)},this.panUp=function(e){var t=this.object.matrix.elements;x.set(t[4],t[5],t[6]),x.multiplyScalar(e),L.add(x)},this.pan=function(e,t){var n=p.domElement===document?p.domElement.body:p.domElement;if(void 0!==p.object.fov){var r=p.object.position.clone().sub(p.target).length();r*=Math.tan(p.object.fov/2*a/180),p.panLeft(2*e*r/n.clientHeight),p.panUp(2*t*r/n.clientHeight)}else void 0===p.object.top?console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."):(p.panLeft(e*(p.object.right-p.object.left)/n.clientWidth),p.panUp(t*(p.object.top-p.object.bottom)/n.clientHeight))},this.dollyIn=function(e){void 0===e&&(e=i()),w/=e},this.dollyOut=function(e){void 0===e&&(e=i()),w*=e},this.update=function(){void 0!==p.object.top&&(this.object.top=w*this.object.top,this.object.bottom=w*this.object.bottom,this.object.left=w*this.object.left,this.object.right=w*this.object.right,this.object.updateProjectionMatrix());var e=this.object.position;g.copy(e).sub(this.target),this.target.add(L),e.copy(this.target).add(g),this.object.lookAt(this.target),this.dispatchEvent(P),w=1,L.set(0,0,0)},this.reset=function(){T=O.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.update()},this.domElement.addEventListener("contextmenu",(function(e){e.preventDefault()}),!1),this.domElement.addEventListener("mousedown",(function(e){if(!1!==p.enabled){if(e.preventDefault(),0===e.button){if(!0===p.noRotate)return;T=O.ROTATE,d.set(e.clientX,e.clientY)}else if(1===e.button){if(!0===p.noZoom)return;T=O.DOLLY,m.set(e.clientX,e.clientY)}else if(2===e.button){if(!0===p.noPan)return;T=O.PAN,h.set(e.clientX,e.clientY)}p.domElement.addEventListener("mousemove",s,!1),p.domElement.addEventListener("mouseup",c,!1),p.dispatchEvent(S)}}),!1),this.domElement.addEventListener("mousewheel",l,!1),this.domElement.addEventListener("DOMMouseScroll",l,!1),this.domElement.addEventListener("touchstart",(function(e){if(!1!==p.enabled){switch(e.touches.length){case 1:if(!0===p.noRotate)return;T=O.TOUCH_ROTATE,d.set(e.touches[0].pageX,e.touches[0].pageY);break;case 2:if(!0===p.noZoom)return;T=O.TOUCH_DOLLY;var n=e.touches[0].pageX-e.touches[1].pageX,a=e.touches[0].pageY-e.touches[1].pageY,r=t(n*n+a*a);m.set(0,r);break;case 3:if(!0===p.noPan)return;T=O.TOUCH_PAN,h.set(e.touches[0].pageX,e.touches[0].pageY);break;default:T=O.NONE}p.dispatchEvent(S)}}),!1),this.domElement.addEventListener("touchend",(function(){!1===p.enabled||(p.dispatchEvent(A),T=O.NONE)}),!1),this.domElement.addEventListener("touchmove",(function(e){if(!1!==p.enabled){e.preventDefault(),e.stopPropagation();var n=p.domElement===document?p.domElement.body:p.domElement;switch(e.touches.length){case 1:if(!0===p.noRotate)return;if(T!==O.TOUCH_ROTATE)return;f.set(e.touches[0].pageX,e.touches[0].pageY),v.subVectors(f,d),p.rotateLeft(2*a*v.x/n.clientWidth*p.rotateSpeed),p.rotateUp(2*a*v.y/n.clientHeight*p.rotateSpeed),d.copy(f),p.update();break;case 2:if(!0===p.noZoom)return;if(T!==O.TOUCH_DOLLY)return;var r=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY,i=t(r*r+o*o);k.set(0,i),E.subVectors(k,m),0<E.y?p.dollyOut():p.dollyIn(),m.copy(k),p.update();break;case 3:if(!0===p.noPan)return;if(T!==O.TOUCH_PAN)return;b.set(e.touches[0].pageX,e.touches[0].pageY),y.subVectors(b,h),p.pan(y.x,y.y),h.copy(b),p.update();break;default:T=O.NONE}}}),!1),window.addEventListener("keydown",(function(e){if(!1!==p.enabled&&!0!==p.noKeys&&!0!==p.noPan)switch(e.keyCode){case p.keys.UP:p.pan(0,p.keyPanSpeed),p.update();break;case p.keys.BOTTOM:p.pan(0,-p.keyPanSpeed),p.update();break;case p.keys.LEFT:p.pan(p.keyPanSpeed,0),p.update();break;case p.keys.RIGHT:p.pan(-p.keyPanSpeed,0),p.update()}}),!1)}function c(e,t,n,a,o){var i,c,p=(new l.DXFLoader).loadEntities(e,o).entities,d=new u.Scene,f={min:{x:!1,y:!1,z:!1},max:{x:!1,y:!1,z:!1}};for(i=0;i<p.length;i++){if(c=p[i]){var v=(new u.Box3).setFromObject(c);v.min.x&&(!1===f.min.x||f.min.x>v.min.x)&&(f.min.x=v.min.x),v.min.y&&(!1===f.min.y||f.min.y>v.min.y)&&(f.min.y=v.min.y),v.min.z&&(!1===f.min.z||f.min.z>v.min.z)&&(f.min.z=v.min.z),v.max.x&&(!1===f.max.x||f.max.x<v.max.x)&&(f.max.x=v.max.x),v.max.y&&(!1===f.max.y||f.max.y<v.max.y)&&(f.max.y=v.max.y),v.max.z&&(!1===f.max.z||f.max.z<v.max.z)&&(f.max.z=v.max.z),d.add(c)}c=null}var h=(n=n||t.clientWidth)/(a=a||t.clientHeight),b=f.max.x,y=f.max.y,x=f.min.x,g=f.min.y,m=b-x,k=y-g,E=E||{x:m/2+x,y:k/2+g};h>r(m/k)?m=k*h:k=m/h;var w={bottom:-k/2,left:-m/2,top:k/2,right:m/2,center:{x:E.x,y:E.y}},L=new u.OrthographicCamera(w.left,w.right,w.top,w.bottom,1,19);L.position.z=10,L.position.x=w.center.x,L.position.y=w.center.y;var O=this.renderer=new u.WebGLRenderer;O.setSize(n,a),O.setClearColor(268435455,1),t.appendChild(O.domElement),t.style.display="block";var T=new s(L,t);T.target.x=L.position.x,T.target.y=L.position.y,T.target.z=0,T.zoomSpeed=3,T.enableRotate=!1,this.render=function(){O.render(d,L)},T.addEventListener("change",this.render),this.render(),T.update(),this.resize=function(e,t){var n=e/O.domElement.width,a=t/O.domElement.height;L.top=a*L.top,L.bottom=a*L.bottom,L.left=n*L.left,L.right=n*L.right,O.setSize(e,t),O.setClearColor(268435455,1),this.render()}}i.r(o),i.d(o,"Viewer",(function(){return c}));var u=i(0);s.prototype=Object.create(u.EventDispatcher.prototype);var l=i(3)}])}));